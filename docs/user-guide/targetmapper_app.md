# TargetMapper App

## Purpose

The TargetMapper App provides a browser-based user interface to review ballot styles to create a "Target Map", which can be used by AuditEngine to evaluate votes on each hand-marked ballot image. In many cases, if "Ballot Style Masters" are available in searchable PDF form, then those can be parsed and the location of each oval linked to the contest and option in that contest without needing this  mapping step. However, of those are not available, then TargetMapper can be used to create the map.

## Basic Concepts

### Ballot Styles

In a given election, there are typically dozens or hundreds of different ballot styles. Each ballot style will have a specific layout, with a set of contests and each selectable option in a fixed location. But depending on where the voter may reside, a different set of contests may be appropriate, based on which congressional district, school district, healthcare district, etc. is appropriate for that location.

Styles may also differ due to language or option rotation (where options are placed in different order). Sometimes, different styles may be exactly the same, if the designers of the ballots changed style numbers for each precinct, for example.

### Style Numbers

On each hand-marked paper ballot, there will be a style number encoded on the ballot using proprietary or standard barcodes.

### Contest

A contest will have a unique name, which is used in the cast-vote record (CVR). This name may differ somewhat from what is actually printed on the ballot. But generally, the contest name on the ballot will be exactly the same on all styles, and it will have the same options (although they might be rotated and in a different order). There may also be write-in lines associated with the contest.

### Option

An option is a candidate name or sometimes a Yes or No (or similar) if it is a referendum or question type contest. Option names generally do not vary between the CVR and ballot, but sometimes they will.

## Preparation

Prior to using TargetMapper, the initial stages of AuditEngine must be run to prepare the data for processing, and run the stage 'build_target_mapper_package'. If TargetMapper needs to be used, then we do not have the ballot style masters and we can't use automapping. The ballots will be parsed to discover all the style numbers, and then clean style masters will be generated by combining many images of the same styles.

## TargetMapper Layout

![image-20240902141436382](C:\Users\raylu\AppData\Roaming\Typora\typora-user-images\image-20240902141436382.png)

There are three major panes in the layout of the application

1. **Ballot Image pane** -- This pane will show one side of one ballot style template.
   1. The image can be zoomed in, panned, and rotated using the mouse, scroll wheel and dragging gestures.
   2. The magnified lock icon can be used to lock the zoom, pan and rotation for that side.
   3. There is a second set of rotation buttons to rotate the red text that is added to the image.
2. **Style List** -- This pane lists the styles to be mapped, with one line item per side.
   1. to work on just one side or the other, use the Page 1, Page 2 check boxes.
   2. The check boxes are use to indicate that you have verified that the side is completed.
   3. A clock face is used to indicate whether all contests have been mapped among both sides.
3. **Contest/Options List** -- This pane provides the contests and options that can be mapped to the style selected.
   1. "Show All" -- means that all contests will be shown regardless of the contests defined for this ballot style.
   2. "Expand All" -- means the options will be shown for each contest. The plus symbol "+" can be used to selectively expand one contests and show the options, and "-" can be used to minimize the contest.
   3. The edit button can be used to edit the order of the options.

## Primary Flow

There are a number of nuances and details for special case, but primarily, the workflow is as follows:

1. **Select The Next Style** **in the Style List** -- Click on the style and page to be mapped. That will bring up the style template image.
2. **Select the Next Contest in the Contest/Options List** -- Click on the next contest to be mapped. All contests for both sides of the template will be listed.
3. **Find the oval for that contest and option** -- Use the mouse to click the oval to place the target indicator on the image.
   1. Double click to delete the target indicator
   2. Drag the target indicator to adjust. Normally the snap-grid will be provided and it will snap to the closest allowed location.
4. **Move to the Next Option** -- There are two ways to select the next option for mapping. When selected for mapping, the option will change to "Yellow".
   1. Click the next option in the Contest/Options list.
   2. Press "n" for "next"
5. **Continue from 3.**

If the options are in the right order, the mapping process can proceed very quickly. If they are not in the correct option, then click the "Edit (pencil on paper)" icon and edit the order of the options.

